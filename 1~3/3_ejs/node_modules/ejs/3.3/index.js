var http = require('http');
var fs = require('fs');
// EJSを扱うためのオブジェクトを生成
var ejs = require('ejs');

var main = fs.readFileSync('./main.ejs','utf-8');
var sub = fs.readFileSync('./sub.ejs','utf-8');

var server = http.createServer(function(req,res){
  // EJSを使ったレンダリング
  // 第一引数：fsオブジェクトで予め読み込んでおいたテンプレートを指定
  // 第二引数：テンプレート上の特殊タグに埋め込むための値を連想配列で指定
  var data = ejs.render(main,{
    contents: ejs.render(sub,{
      data: '<p>hogehoge</p>'
    })
  });
   res.writeHead(200,{'Content-Type': 'text/html'});
   res.write(data);
   res.end();
});

server.listen(1234);
console.log('サーバを起動しました');
